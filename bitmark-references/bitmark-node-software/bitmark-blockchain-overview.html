<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="">
<meta name="keywords" content=" blockchain">
<title>Bitmark Blockchain Technical Overview | Bitmark Documentation</title>

<link rel="stylesheet" href="/css/syntax.css">

<link rel="stylesheet" type="text/css" href="/css/font-awesome.min.css">
<!--<link rel="stylesheet" type="text/css" href="/css/bootstrap.min.css">-->
<link rel="stylesheet" href="/css/modern-business.css">
<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="/css/bootstrap.min.3.3.7.css" crossorigin="anonymous">
<link rel="stylesheet" href="/css/customstyles.css">
<link rel="stylesheet" href="/css/boxshadowproperties.css">
<!-- most color styles are extracted out to here -->
<link rel="stylesheet" href="/css/theme-blue.css">

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script src="/js/jquery.navgoco.min.js"></script>


<!-- Latest compiled and minified JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<!-- Anchor.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.2.0/anchor.min.js"></script>
<script src="/js/toc.js"></script>
<script src="/js/customscripts.js"></script>

<link rel="shortcut icon" href="/assets/images/favicon.ico">

<link rel="stylesheet" href="/css/uikit.min.css" />
<script src="/js/uikit.min.js"></script>

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->

<link rel="alternate" type="application/rss+xml" title="docs" href="http://localhost:4000/feed.xml">

    <script>
        $(document).ready(function() {
            // Initialize navgoco with default options
            $("#mysidebar").navgoco({
                caretHtml: '',
                accordion: false,
                openClass: 'active', // open
                save: false, // leave false or nav highlighting doesn't work right
                cookie: {
                    name: 'navgoco',
                    expires: false,
                    path: '/'
                },
                slide: {
                    duration: 250,
                    easing: 'swing'
                }
            });

            // expand first level at indexes [0,3,7] 
            $("#mysidebar").navgoco('toggle', true, 0, 3, 7);

            $("#collapseAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', false);
            });

            $("#expandAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', true);
            });

        });

    </script>
    <script>
        $(function () {
            $('[data-toggle="tooltip"]').tooltip()
        })
    </script>
    <script>
        $(document).ready(function() {
            $("#tg-sb-link").click(function() {
                $("#tg-sb-sidebar").toggle();
                $("#tg-sb-content").toggleClass('col-md-9');
                $("#tg-sb-content").toggleClass('col-md-12');
                $("#tg-sb-icon").toggleClass('fa-toggle-on');
                $("#tg-sb-icon").toggleClass('fa-toggle-off');
            });
        });
    </script>
    

</head>
<body>
<!-- Navigation -->
<nav class="navbar navbar-inverse navbar-fixed-top">
    <div class="container topnavlinks">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/index.html"><span class="projectTitle home-logo"><img src="/assets/images/Bitmark_Logo-desktop_white.svg" alt="Bitmark logo"/><!-- Home --></span></a>
        </div>
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <!-- toggle sidebar button -->
                <li><a id="tg-sb-link" href="#"><i id="tg-sb-icon" class="fa fa-toggle-on"></i> Nav</a></li>
                <!-- entries without drop-downs appear here -->




                
                
                
                <li><a href="https://github.com/bitmark-inc/docs" target="_blank" rel="noopener">GitHub</a></li>
                
                
                
                <!-- entries with drop-downs appear here -->
                <!-- conditional logic to control which topnav appears for the audience defined in the configuration file.-->
                
                
			<li>



  <a class="email" title="Submit feedback" href="#" onclick="javascript:window.location='mailto:support@bitmark.com?subject=Bitmark Inc feedback&body=I have some feedback about the Bitmark Blockchain Technical Overview page: ' + window.location.href;"><i class="fa fa-envelope-o"></i> Need help?</a>

</li>

		
                <!--comment out this block if you want to hide search-->
                <li>
                    <!--start search-->
                    <div id="search-demo-container">
                        <input type="text" id="search-input" placeholder="search...">
                        <ul id="results-container"></ul>
                    </div>
                    <script src="/js/jekyll-search.js" type="text/javascript"></script>
                    <script type="text/javascript">
                            SimpleJekyllSearch.init({
                                searchInput: document.getElementById('search-input'),
                                resultsContainer: document.getElementById('results-container'),
                                dataSource: '/search.json',
                                searchResultTemplate: '<li><a href="{url}" title="Bitmark Blockchain Technical Overview">{title}</a></li>',
                    noResultsText: 'No results found.',
                            limit: 10,
                            fuzzy: true,
                    })
                    </script>
                    <!--end search-->
                </li>
            </ul>
        </div>
        </div>
        <!-- /.container -->
</nav>

<!-- Page Content -->
<div class="container">
  <div id="main">
    <!-- Content Row -->
    <div class="row">
        
        
            <!-- Sidebar Column -->
            <div class="col-md-3" id="tg-sb-sidebar">
                

<ul id="mysidebar" class="nav">
  <li class="sidebarTitle"> </li>
  
  
  
  <li>
      <a title="Learning Bitmark" href="#">Learning Bitmark</a>
      <ul>
          
          
          
          <li><a title="Bitmark Property System" href="/learning-bitmark/bitmark-property-system-introduction">Bitmark Property System</a></li>
          
          
          
          
          
          
          <li><a title="Bitmark Blockchain" href="/learning-bitmark/bitmark-blockchain">Bitmark Blockchain</a></li>
          
          
          
          <li class="subfolders">
              <a title="Quick Start" href="">Quick Start</a>
              <ul>
                  
                  
                  
                  <li><a title="Run a Bitmark Node" href="/learning-bitmark/quick-start/simple-solution-for-node-setup">Run a Bitmark Node</a></li>
                  
                  
                  
                  
                  
                  <li><a title="Creating Bitmark Account" href="/learning-bitmark/quick-start/working-with-bitmarks/creating-bitmark-account">Creating Bitmark Account</a></li>
                  
                  
                  
                  
                  
                  <li><a title="Registering Bitmark Certificates" href="/learning-bitmark/quick-start/working-with-bitmarks/issuing-bitmarks">Registering Bitmark Certificates</a></li>
                  
                  
                  
                  
                  
                  <li><a title="Transferring Bitmark Certificates" href="/learning-bitmark/quick-start/working-with-bitmarks/transferring-bitmarks">Transferring Bitmark Certificates</a></li>
                  
                  
                  
                  
                  
                  <li><a title="Using Bitmark Shares" href="/learning-bitmark/quick-start/working-with-bitmarks/using-bitmark-shares">Using Bitmark Shares</a></li>
                  
                  
                  
                  
                  
                  <li><a title="Bitmark-CLI Payment" href="/learning-bitmark/quick-start/working-with-bitmarks/bitmark-cli-payment">Bitmark-CLI Payment</a></li>
                  
                  
                  
              </ul>
          </li>
          
          
          
          <li class="subfolders">
              <a title="Contributing to Bitmark" href="">Contributing to Bitmark</a>
              <ul>
                  
                  
                  
                  <li><a title="Bitmark Software Development Process" href="/learning-bitmark/contributing-to-bitmark/bitmark-software-development-process">Bitmark Software Development Process</a></li>
                  
                  
                  
                  
                  
                  <li><a title="Bitmark Upgrade Proposal" href="/learning-bitmark/contributing-to-bitmark/bup">Bitmark Upgrade Proposal</a></li>
                  
                  
                  
                  
                  
                  <li><a title="Bug Bounty Program" href="/learning-bitmark/contributing-to-bitmark/bug-bounty-program">Bug Bounty Program</a></li>
                  
                  
                  
              </ul>
          </li>
          
          
          
          
          
          
          <li><a title="Bitmark Terms and Glossary" href="/learning-bitmark/bitmark-terms-and-glossary">Bitmark Terms and Glossary</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a title="Bitmark References" href="#">Bitmark References</a>
      <ul>
          
          
          
          <li><a title="Tutorial For Node Setup" href="/bitmark-references/node-setup/tutorial-for-node-setup">Tutorial For Node Setup</a></li>
          
          
          
          <li class="subfolders">
              <a title="Bitmark Node Software" href="">Bitmark Node Software</a>
              <ul>
                  
                  
                  
                  <li class="active"><a title="Bitmark Blockchain Overview" href="/bitmark-references/bitmark-node-software/bitmark-blockchain-overview">Bitmark Blockchain Overview</a></li>
                  
                  
                  
                  
                  
                  <li><a title="RPC Communication" href="/bitmark-references/bitmark-node-software/rpc-communication">RPC Communication</a></li>
                  
                  
                  
                  
                  
                  <li><a title="Block Verification and Synchronization" href="/bitmark-references/bitmark-node-software/block-verification-and-synchronization">Block Verification and Synchronization</a></li>
                  
                  
                  
                  
                  
                  <li><a title="Payment Verification" href="/bitmark-references/bitmark-node-software/payment-verification">Payment Verification</a></li>
                  
                  
                  
                  
                  
                  <li><a title="Bitmark Mining" href="/bitmark-references/bitmark-node-software/bitmark-mining">Bitmark Mining</a></li>
                  
                  
                  
                  
                  
                  <li><a title="Storage" href="/bitmark-references/bitmark-node-software/storage">Storage</a></li>
                  
                  
                  
                  
                  
                  <li><a title="Security" href="/bitmark-references/bitmark-node-software/security">Security</a></li>
                  
                  
                  
              </ul>
          </li>
          
          
          
          <li class="subfolders">
              <a title="Bitmark SDK" href="">Bitmark SDK</a>
              <ul>
                  
                  
                  
                  <li><a title="Getting Started" href="/bitmark-references/bitmark-sdk/getting-started">Getting Started</a></li>
                  
                  
                  
                  
                  
                  <li><a title="Account" href="/bitmark-references/bitmark-sdk/account">Account</a></li>
                  
                  
                  
                  
                  
                  <li><a title="Actions" href="/bitmark-references/bitmark-sdk/action">Actions</a></li>
                  
                  
                  
                  
                  
                  <li><a title="Query" href="/bitmark-references/bitmark-sdk/query">Query</a></li>
                  
                  
                  
                  
                  
                  <li><a title="Migration" href="/bitmark-references/bitmark-sdk/migration">Migration</a></li>
                  
                  
                  
                  
                  
                  <li><a title="Store Seed" href="/bitmark-references/bitmark-sdk/store-seed">Store Seed</a></li>
                  
                  
                  
                  
                  
                  <li><a title="Web Socket" href="/bitmark-references/bitmark-sdk/websocket">Web Socket</a></li>
                  
                  
                  
              </ul>
          </li>
          
          
          
          <li class="subfolders">
              <a title="Bitmark CLI" href="">Bitmark CLI</a>
              <ul>
                  
                  
                  
                  <li><a title="Quick Setup" href="/bitmark-references/bitmark-cli/bitmark-cli-quick-setup">Quick Setup</a></li>
                  
                  
                  
                  
                  
                  <li><a title="Bitmark-CLI Command Reference" href="/bitmark-references/bitmark-cli/bitmark-cli-command-reference">Bitmark-CLI Command Reference</a></li>
                  
                  
                  
              </ul>
          </li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a title="Bitmark Appendix" href="#">Bitmark Appendix</a>
      <ul>
          
          
          
          <li><a title="Bitmark versus Ethereum" href="/bitmark-appendix/bitmark-eth-comparison">Bitmark versus Ethereum</a></li>
          
          
          
          
          
          
          <li><a title="Bitmark Shares" href="/bitmark-appendix/bitmark-shares">Bitmark Shares</a></li>
          
          
          
          
          
          
          <li><a title="Bitmark Papers" href="/bitmark-appendix/bitmark-papers">Bitmark Papers</a></li>
          
          
          
          
      </ul>
   </li>
     
      
      
      <!-- if you aren't using the accordion, uncomment this block:
         <p class="external">
             <a href="#" id="collapseAll">Collapse All</a> | <a href="#" id="expandAll">Expand All</a>
         </p>
         -->
</ul>

<!-- this highlights the active parent class in the navgoco sidebar. this is critical so that the parent expands when you're viewing a page. This must appear below the sidebar code above. Otherwise, if placed inside customscripts.js, the script runs before the sidebar code runs and the class never gets inserted.-->
<script>$("li.active").parents('li').toggleClass("active");</script>

            </div>
            
        

        <!-- Content Column -->
        <div class="col-md-9" id="tg-sb-content">
            <!-- <div class="post-header">
   <h1 class="post-title-main">Bitmark Blockchain Technical Overview</h1>
</div> -->



<div class="post-content">

   

    
    

    <div class="row">
        <div class="col-md-9"><h1 id="bitmark-blockchain-technical-overview">Bitmark Blockchain Technical Overview</h1>

<p>This brief description of the structure of the structure of the Bitmark blockchain moves
from the transactions up to the final structure of the chain
itself.</p>

<h2 id="definitions">Definitions</h2>

<p>The following variable types are used in most Bitmark records:</p>

<dl>
  <dt>Account</dt>
  <dd>An encoded Ed25519 public key. Contains a type code to
allow for other key types. It is preceded by a <em>VarInt</em> <em>byte</em>
count that is currently set to 33.</dd>
  <dt>Binary</dt>
  <dd>A sequence of <em>bytes</em> preceded by a <em>VarInt</em> byte count.  The count is
validated by various routines to prevent excessive storage use.</dd>
  <dt>Byte</dt>
  <dd>A single <em>binary</em> byte.</dd>
  <dt>Map</dt>
  <dd>A sequence of NUL-separated UTF-8 <em>byte</em> sequences preceded by a <em>VarInt</em>
byte count. The count is
validated by various routines to prevent excessive storage use.
There must be an even number of sequences, as they form
key-value pairs. There must not be a trailing NUL byte.  In JSON
representation, the NUL byte will show as <code class="language-plaintext highlighter-rouge">\u0000</code>.</dd>
  <dt>Signature</dt>
  <dd>An Ed25519 signature over all previous <em>bytes</em> including <em>VarInt</em>
fields. It is preceded by a VarInt with a count of 64.  This
value will change once other signature algorithms are used and will
depend on the type code inside the <em>Account</em> field.</dd>
  <dt>String</dt>
  <dd>A sequence of UTF-8 <em>bytes</em> preceded by a <em>VarInt</em> byte count.
The count is validated by various routines to prevent excessive
storage use.</dd>
  <dt>VarInt</dt>
  <dd>A sequence of 1 to 9 <em>bytes</em> that represents a 64-bit unsigned
integer in Little-Endian form. The high bit of each byte is used as a continuation flag,
so 0 … 127 can be represented by each byte. Each successive byte
adds 7 more bits. The 9^th^
byte does not have a continuation flag, so it adds eight bits to the integer, bringing the total for the nine bytes to 64 bits.</dd>
</dl>

<p>The following variable types are used only in Bitmark block headers, because they are fixed length fields:</p>

<dl>
  <dt>Unn</dt>
  <dd>An unsigned integer with a length of “nn” bits. Normally this will be
multiples of 8 bits such as: U8, U16, U32, U64.</dd>
</dl>

<h2 id="transactions-asset-issue-and-transfer-records">Transactions: Asset, Issue, and Transfer Records</h2>

<p>The main types of transactions on the Bitmark blockchain are asset,
issue, and transfer records. Together, they create chains
of provenance for individual copies of specific assets.</p>

<p>Asset records have an identifier that is the SHA3-512 hash of the bytes
making up the fingerprint.  This allows the fingerprint field to contain
any data, binary, or text and to be represented by a fixed length 64-byte
identifier in issue records.  Only using the fingerprint for the hash
prevents duplicate assets that have the same fingerprint but different
names or metadata.</p>

<p>Other transactions have an identifier that is the SHA3-256 hash of
the entire record (including all signatures). This shorter identifier
of 256 bits is used both to save space in records and to easily distinguish
transaction ids from asset ids.</p>

<h3 id="asset-record">Asset Record</h3>

<p>An asset record contains the metadata describing an asset that will be issued on
the blockchain.  All assets will have at least one issue.</p>

<p>The Record structure:</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Item</th>
      <th style="text-align: left">Type</th>
      <th style="text-align: left">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">Type code</td>
      <td style="text-align: left">Byte</td>
      <td style="text-align: left">Asset Record type code</td>
    </tr>
    <tr>
      <td style="text-align: left">Name</td>
      <td style="text-align: left">String</td>
      <td style="text-align: left">Short descriptive name</td>
    </tr>
    <tr>
      <td style="text-align: left">Fingerprint</td>
      <td style="text-align: left">String</td>
      <td style="text-align: left">Unique identifier for the Asset</td>
    </tr>
    <tr>
      <td style="text-align: left">Metadata</td>
      <td style="text-align: left">Map</td>
      <td style="text-align: left">Key-Value to describe Asset</td>
    </tr>
    <tr>
      <td style="text-align: left">Registrant</td>
      <td style="text-align: left">Account</td>
      <td style="text-align: left">Public key of the signer</td>
    </tr>
    <tr>
      <td style="text-align: left">Signature</td>
      <td style="text-align: left">Signature</td>
      <td style="text-align: left">Ed25519 signature of signer</td>
    </tr>
  </tbody>
</table>

<h3 id="issue-record">Issue Record</h3>

<p>An issue record actually issues an asset (or an additional
copy of an asset) to an owner on the Bitmark blockchain.</p>

<p>Each issue must have a unique nonce value to distinguish individual
copies of that asset.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Item</th>
      <th style="text-align: left">Type</th>
      <th style="text-align: left">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">Type code</td>
      <td style="text-align: left">Byte</td>
      <td style="text-align: left">Issue Record type code</td>
    </tr>
    <tr>
      <td style="text-align: left">AssetId</td>
      <td style="text-align: left">Binary</td>
      <td style="text-align: left">Link to asset record (SHA3-512 of asset fingerprint)</td>
    </tr>
    <tr>
      <td style="text-align: left">Owner</td>
      <td style="text-align: left">Account</td>
      <td style="text-align: left">The public key of the signer</td>
    </tr>
    <tr>
      <td style="text-align: left">Nonce</td>
      <td style="text-align: left">VarInt</td>
      <td style="text-align: left">Allow for multiple issues of the same asset</td>
    </tr>
    <tr>
      <td style="text-align: left">Signature</td>
      <td style="text-align: left">Signature</td>
      <td style="text-align: left">Ed25519 signature of signer</td>
    </tr>
  </tbody>
</table>

<h3 id="transfer-record">Transfer Record</h3>

<p>A transfer record transfers ownership of an issued asset in a provenance chain on
the Bitmark blockchain.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Item</th>
      <th style="text-align: left">Type</th>
      <th style="text-align: left">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">Type code</td>
      <td style="text-align: left">Byte</td>
      <td style="text-align: left">Transfer Record type code</td>
    </tr>
    <tr>
      <td style="text-align: left">Link</td>
      <td style="text-align: left">Binary</td>
      <td style="text-align: left">Link to previous Issue or Transfer (SHA3-256 of previous transaction)</td>
    </tr>
    <tr>
      <td style="text-align: left">Escrow</td>
      <td style="text-align: left">Payment</td>
      <td style="text-align: left">Optional escrow payment and address</td>
    </tr>
    <tr>
      <td style="text-align: left">Owner</td>
      <td style="text-align: left">Account</td>
      <td style="text-align: left">The public key of the new owner</td>
    </tr>
    <tr>
      <td style="text-align: left">Signature</td>
      <td style="text-align: left">Signature</td>
      <td style="text-align: left">Ed25519 signature of linked previous owner</td>
    </tr>
    <tr>
      <td style="text-align: left">CounterSignature</td>
      <td style="text-align: left">Signature</td>
      <td style="text-align: left">Ed25519 signature of this record owner</td>
    </tr>
  </tbody>
</table>

<h2 id="transactions-share">Transactions: Share</h2>

<p>The Bitmark blockchain also supports transactions that deal with fractional bitmarks as a
kind of fungible token.</p>

<h3 id="share-balance-record">Share Balance Record</h3>

<p>A share balance record marks the end of a provenance chain. It splits the issued asset
into an initial quantity of shares.  From this point on, the shares can
 be granted or swapped with other Bitmark accounts.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Item</th>
      <th style="text-align: left">Type</th>
      <th style="text-align: left">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">Type code</td>
      <td style="text-align: left">Byte</td>
      <td style="text-align: left">Bitmark Balance type code</td>
    </tr>
    <tr>
      <td style="text-align: left">Link</td>
      <td style="text-align: left">Binary</td>
      <td style="text-align: left">Link to previous Issue or Transfer (SHA3-256 of previous transaction)</td>
    </tr>
    <tr>
      <td style="text-align: left">Quantity</td>
      <td style="text-align: left">VarInt</td>
      <td style="text-align: left">Initial balance quantity</td>
    </tr>
    <tr>
      <td style="text-align: left">Signature</td>
      <td style="text-align: left">Signature</td>
      <td style="text-align: left">Ed25519 signature of linked previous owner</td>
    </tr>
  </tbody>
</table>

<h3 id="share-grant-record">Share Grant Record</h3>

<p>A share grant record moves a quantity of shares from one owner to another.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Item</th>
      <th style="text-align: left">Type</th>
      <th style="text-align: left">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">Type code</td>
      <td style="text-align: left">Byte</td>
      <td style="text-align: left">Share Grant type code</td>
    </tr>
    <tr>
      <td style="text-align: left">ShareId</td>
      <td style="text-align: left">Binary</td>
      <td style="text-align: left">Link to previous Issue (SHA3-256 of issue transaction)</td>
    </tr>
    <tr>
      <td style="text-align: left">Quantity</td>
      <td style="text-align: left">VarInt</td>
      <td style="text-align: left">Number of shares to transfer to recipient</td>
    </tr>
    <tr>
      <td style="text-align: left">Owner</td>
      <td style="text-align: left">Account</td>
      <td style="text-align: left">Public key of the current owner</td>
    </tr>
    <tr>
      <td style="text-align: left">Recipient</td>
      <td style="text-align: left">Account</td>
      <td style="text-align: left">Public key of the new owner</td>
    </tr>
    <tr>
      <td style="text-align: left">BeforeBlock</td>
      <td style="text-align: left">VarInt</td>
      <td style="text-align: left">Expiry block height for transaction</td>
    </tr>
    <tr>
      <td style="text-align: left">Signature</td>
      <td style="text-align: left">Signature</td>
      <td style="text-align: left">Ed25519 signature of current owner</td>
    </tr>
    <tr>
      <td style="text-align: left">CounterSignature</td>
      <td style="text-align: left">Signature</td>
      <td style="text-align: left">Ed25519 signature of recipient</td>
    </tr>
  </tbody>
</table>

<h3 id="share-swap-record">Share Swap Record</h3>

<p>A share swap record performs an atomic swap between two owners
with two different share types.  The action is indivisible, and there
is no possibility of a half transaction being executed.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Item</th>
      <th style="text-align: left">Type</th>
      <th style="text-align: left">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">Type code</td>
      <td style="text-align: left">Byte</td>
      <td style="text-align: left">Share Swap type code</td>
    </tr>
    <tr>
      <td style="text-align: left">ShareIdOne</td>
      <td style="text-align: left">Binary</td>
      <td style="text-align: left">Link to previous Issue (SHA3-256 of issue transaction)</td>
    </tr>
    <tr>
      <td style="text-align: left">QuantityOne</td>
      <td style="text-align: left">VarInt</td>
      <td style="text-align: left">Number of shares one to transfer to owner two</td>
    </tr>
    <tr>
      <td style="text-align: left">OwnerOne</td>
      <td style="text-align: left">Account</td>
      <td style="text-align: left">The public key of the share one owner</td>
    </tr>
    <tr>
      <td style="text-align: left">ShareIdTwo</td>
      <td style="text-align: left">Binary</td>
      <td style="text-align: left">Link to previous Issue (SHA3-256 of issue transaction)</td>
    </tr>
    <tr>
      <td style="text-align: left">QuantityTwo</td>
      <td style="text-align: left">VarInt</td>
      <td style="text-align: left">Number of shares two to transfer to owner one</td>
    </tr>
    <tr>
      <td style="text-align: left">OwnerTwo</td>
      <td style="text-align: left">Account</td>
      <td style="text-align: left">The public key of the share two owner</td>
    </tr>
    <tr>
      <td style="text-align: left">BeforeBlock</td>
      <td style="text-align: left">VarInt</td>
      <td style="text-align: left">Expiry block height for transaction</td>
    </tr>
    <tr>
      <td style="text-align: left">Signature</td>
      <td style="text-align: left">Signature</td>
      <td style="text-align: left">Ed25519 signature of owner one</td>
    </tr>
    <tr>
      <td style="text-align: left">CounterSignature</td>
      <td style="text-align: left">Signature</td>
      <td style="text-align: left">Ed25519 signature of owner two</td>
    </tr>
  </tbody>
</table>

<h2 id="transactions-block-ownership">Transactions: Block Ownership</h2>

<p>Finally, the Bitmark blockchain also supports a few transactions for defining block ownership.</p>

<h3 id="block-foundation-record">Block Foundation Record</h3>

<p>A block foundation record is the first transaction in a block and defines the ownership of
that block.  It is only set by the block mining process.  It is also
used to set the miner’s payment addresses, which are used when
transactions reference those in the block.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Item</th>
      <th style="text-align: left">Type</th>
      <th style="text-align: left">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">Type code</td>
      <td style="text-align: left">Byte</td>
      <td style="text-align: left">Block Foundation type code</td>
    </tr>
    <tr>
      <td style="text-align: left">Version</td>
      <td style="text-align: left">VarInt</td>
      <td style="text-align: left">Sets the combination of supported currencies</td>
    </tr>
    <tr>
      <td style="text-align: left">Payments</td>
      <td style="text-align: left">Map</td>
      <td style="text-align: left">Map of Currency and Address</td>
    </tr>
    <tr>
      <td style="text-align: left">Owner</td>
      <td style="text-align: left">Account</td>
      <td style="text-align: left">Public key of the owner</td>
    </tr>
    <tr>
      <td style="text-align: left">Nonce</td>
      <td style="text-align: left">VarInt</td>
      <td style="text-align: left">Additional NONCE for mining</td>
    </tr>
    <tr>
      <td style="text-align: left">Signature</td>
      <td style="text-align: left">Signature</td>
      <td style="text-align: left">Ed25519 signature of owner</td>
    </tr>
  </tbody>
</table>

<h3 id="block-owner-transfer-record">Block Owner Transfer Record</h3>

<p>A block owner transfer record allows the current owner of a block to transfer any
future earnings from that block to another owner, with new currency
addresses.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Item</th>
      <th style="text-align: left">Type</th>
      <th style="text-align: left">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">Type code</td>
      <td style="text-align: left">Byte</td>
      <td style="text-align: left">Block Foundation type code</td>
    </tr>
    <tr>
      <td style="text-align: left">Link</td>
      <td style="text-align: left">Binary</td>
      <td style="text-align: left">Link to previous Foundation or Block Transfer (SHA3-256 of previous transaction)</td>
    </tr>
    <tr>
      <td style="text-align: left">Escrow</td>
      <td style="text-align: left">Payment</td>
      <td style="text-align: left">Optional escrow payment and address</td>
    </tr>
    <tr>
      <td style="text-align: left">Version</td>
      <td style="text-align: left">VarInt</td>
      <td style="text-align: left">Sets the combination of supported currencies</td>
    </tr>
    <tr>
      <td style="text-align: left">Payments</td>
      <td style="text-align: left">Map</td>
      <td style="text-align: left">Map of Currency and Address</td>
    </tr>
    <tr>
      <td style="text-align: left">Owner</td>
      <td style="text-align: left">Account</td>
      <td style="text-align: left">Public key of the new owner</td>
    </tr>
    <tr>
      <td style="text-align: left">Signature</td>
      <td style="text-align: left">Signature</td>
      <td style="text-align: left">Ed25519 signature of linked previous owner</td>
    </tr>
    <tr>
      <td style="text-align: left">CounterSignature</td>
      <td style="text-align: left">Signature</td>
      <td style="text-align: left">Ed25519 signature of this record owner</td>
    </tr>
  </tbody>
</table>

<h2 id="blockchain-structure">Blockchain structure</h2>

<p>Transactions are gathered together into blocks, which start with a
block header, followed by a single foundation record and then the rest of the
transactions.</p>

<p>A block is secured by having a nonce and a difficulty
value embedded in the header. The difficulty can only change at
specific points and in specific ways defined in the <code class="language-plaintext highlighter-rouge">bitmarkd</code> consensus
algorithm; any block with a difficulty that does not comply is
immediately rejected. It is possible to determine if a header
is valid by checking if its hash value is less than or equal to the
value indicated by the difficulty.</p>

<p>The chain itself is formed by storing the hash of the previous block in the
block header, which links the current block to the previous block.</p>

<h3 id="block-header">Block Header</h3>

<p>The block header is used both to provide metadata (like timestamp) for
a block and to verify that the list of transactions attached
to the block are valid.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Item</th>
      <th style="text-align: left">Type</th>
      <th style="text-align: left">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">Version</td>
      <td style="text-align: left">U16</td>
      <td style="text-align: left">Version of block rules in action</td>
    </tr>
    <tr>
      <td style="text-align: left">TransactionCount</td>
      <td style="text-align: left">U16</td>
      <td style="text-align: left">Number of transactions in the block</td>
    </tr>
    <tr>
      <td style="text-align: left">Number</td>
      <td style="text-align: left">U64</td>
      <td style="text-align: left">The number of this block</td>
    </tr>
    <tr>
      <td style="text-align: left">PreviousBlock</td>
      <td style="text-align: left">Argon2</td>
      <td style="text-align: left">Thirty-two byte hash of the previous block</td>
    </tr>
    <tr>
      <td style="text-align: left">MerkleRoot</td>
      <td style="text-align: left">SHA3-256</td>
      <td style="text-align: left">Thirty-two byte hash of the transaction Merkle tree</td>
    </tr>
    <tr>
      <td style="text-align: left">Timestamp</td>
      <td style="text-align: left">U64</td>
      <td style="text-align: left">UNIX timestamp (seconds after start of 1970-01-01)</td>
    </tr>
    <tr>
      <td style="text-align: left">Difficulty</td>
      <td style="text-align: left">U64</td>
      <td style="text-align: left">Difficulty fraction as 57 bit mantissa + 8 bit exponent</td>
    </tr>
    <tr>
      <td style="text-align: left">Nonce</td>
      <td style="text-align: left">U64</td>
      <td style="text-align: left">Nonce created by hashing to meet the difficulty</td>
    </tr>
  </tbody>
</table>

<h3 id="merkle-tree">Merkle Tree</h3>

<p>A Merkle Tree combines the hashes of individual records, such that
only the same records hashed together in the same order will result in
the same Merkle Tree root. It does so by hashing individual
transactions using the SHA3-256 algorithm to create the leaves of a binary tree. Each pair of
hashes in the tree is then combined to form a new hash. Whenever a hash in the tree does not have a paired hash to
combine with, it is instead hashed with itself.  This process is repeated until only a single hash is left: the Merkle Tree
root.</p>

<p>The SHA3 algorithm is the current recommended hashing algorithm to use
and fixes some vulnerability problems that were found in SHA2.  The
SHA2 algorithm would have to be used twice to protect against this, which would
cost more CPU resources.  The SHA3 is faster, so it reduces the time to
build the Merkle Tree. SHA1 has been broken, so it was not considered.</p>

<p>The SHA3 algorithm is also used for transaction IDs and is similarly the
hash of the packed binary transaction including all signatures.</p>

<h3 id="block-hashing-argon2-difficulty-proof-of-work-">Block Hashing (argon2, difficulty, proof of work …)</h3>

<p>To prevent hardware attack of the Proof of Work system using GPUs or
ASICs, a memory hard algorithm is used: Argon2.  Its parameters are
set such that a GPU will be some orders of magnitude slower that a
typical x86 CPU core.  The current setting for the hashing power of CPUs
is still very low, on the order of a few hashes per second; this means
that the difficulty scale is much lower than other blockchain systems.</p>

<p>The difficulty is represented as a
<a href="floating
point">https://en.wikipedia.org/wiki/Floating-point_arithmetic</a> value in the range:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1 ≥ d &gt; 0
</code></pre></div></div>

<p>The difficulty value is encoded as a 57-bit mantissa, normalized so
that the most significant bit is one and can be dropped, leaving 56 bits
to store:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    [8 bits exponent][56 bits mantissa] = 64 bit unsigned value

    mantissa is right shifted by exponent+8 from the most significant bit
    
    Examples:
     the "One" value: 00 ff  ff ff  ff ff  ff ff
     represents the 256 bit value: 00ff ffff ffff ffff 8000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000

     value: 01 ff  ff ff  ff ff  ff ff
     represents the 256 bit value: 007f ffff ffff ffff c000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000

    Notes:
      1. the values here are shown as big endian, but the header is stored little endian
      2. the "one" value represents exactly a difficulty of 1.0 in the packed 64 bits
</code></pre></div></div>

<p>The hash is considered as a 256-bit fixed point value with 8 bits
before the decimal point:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[8 bits] . [248 bits]
</code></pre></div></div>

<p>A hash meets the difficulty if its value is less than or equal to
difficulty value.</p>

</div>
        
        <div class="col-md-3">
<!-- this handles the automatic toc. use ## for subheads to auto-generate the on-page minitoc. if you use html tags, you must supply an ID for the heading element in order for it to appear in the minitoc. -->
<script>
$( document ).ready(function() {
  // Handler for .ready() called.

$('#toc').toc({ minimumHeaders: 0, listType: 'ul', showSpeed: 0, headers: 'h2,h3,h4' });

/* this offset helps account for the space taken up by the floating toolbar. */
$('#toc').on('click', 'a', function() {
  var target = $(this.getAttribute('href'))
    , scroll_target = target.offset().top

  $(window).scrollTop(scroll_target - 10);
  return false
})
  
});
</script>

<div id="toc" class="affix"></div>
</div>
        
    </div>

    

    <div class="tags">
        
    </div>




</div>

<hr class="shaded"/>

<footer>
            <div class="row">
                <div class="col-lg-12 footer">
               	&copy;2020 Bitmark Inc. All rights reserved.
				<br/> Powered by <a href="https://jekyllrb.com/">Jekyll</a>
<!-- <p><img src="/assets/images/company_logo.png" alt="Company logo"/></p>
                </div>
            </div> -->
</footer>


        </div>
    <!-- /.row -->
</div>
<!-- /.container -->
</div>
<!-- /#main -->
    </div>

</body>

</html>
